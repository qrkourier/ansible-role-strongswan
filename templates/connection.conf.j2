# {{ ansible_managed }}

conn {{ item.0.name }}
  # Connection Settings
{% for option in [
       'auto', 'closeaction', 'type', 'authby', 'ike', 'aggressive',
       'fragmentation', 'ah', 'esp', 'compress', 'ikelifetime',
       'ikelife', 'keyexchange', 'keytime', 'lifetime', 'margintime',
       'rekeymargin', 'rekeyfuzz', 'keyingtries', 'dpdaction', 'dpddelay', 'mask',
       'reauth', 'rekey', 'dpdaction', 'dpdtimeout' ] %}
{%   if item.0.conn[option] is defined %}
  {{ option }}={{ item.0.conn[option] }}
{%   endif %}
{% endfor %}
  # Local Settings
{%   if item.0.left.address is defined %}
  left={{ item.0.left.address }}
{%   endif %}
{% for option in [
       'ikeport', 'protoport', 'subnet', 'sourceip', 'allowany', 'id',
       'auth', 'ca', 'cert', 'sendcert', 'dns', 'firewall', 'updown' ] %}
{%   if item.0.left[option] is defined %}
  left{{ option }}={{ item.0.left[option] }}
{%   endif %}
{% endfor %}
  # Remote Settings
{%   if item.0.right.address is defined %}
  right={{ item.0.right.address }}
{%   endif %}
{% for option in [
       'ikeport', 'protoport', 'subnet', 'sourceip', 'allowany', 'id',
       'auth', 'ca', 'cert', 'sendcert', 'dns', 'firewall', 'updown' ] %}
{%   if item.0.right[option] is defined %}
  right{{ option }}={{ item.0.right[option] }}
{%   endif %}
{% endfor %}
